{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {},
  "variables": {
    "singleQuote": "'",
    "logAnalytics": "[concat('[parameters(', variables('singleQuote'), 'logAnalytics', variables('singleQuote'), ')]')]",
    "resourceName": "[concat('[parameters(', variables('singleQuote'), 'resourceName', variables('singleQuote'), ')]')]",
    "resourceDiagName": "[concat('[concat(', 'parameters(', variables('singleQuote'), 'resourceName', variables('singleQuote'), ')', ', ', variables('singleQuote'), '/', variables('singleQuote'), ', ', variables('singleQuote'), 'Microsoft.Insights/setByPolicy', variables('singleQuote'), ')]')]",
    "resourceNameField": "[concat('[field(', variables('singleQuote'), 'name', variables('singleQuote'), ')]')]",
    "resourceFullNameField": "[concat('[field(', variables('singleQuote'), 'fullName', variables('singleQuote'), ')]')]",
    "location": "[concat('[parameters(', variables('singleQuote'), 'location', variables('singleQuote'), ')]')]",
    "locationField": "[concat('[field(', variables('singleQuote'), 'location', variables('singleQuote'), ')]')]",
    "policyDescription": "This policy automatically deploys and enable diagnostic settings to Log Analytics",
    "nicDiagPolicyName": "nic-diagnostic-settings-policyDef",
    "aaDiagPolicyName": "aa-diagnostic-settings-policyDef",
    "pipDiagPolicyName": "pip-diagnostic-settings-policyDef",
    "lbDiagPolicyName": "lb-diagnostic-settings-policyDef",
    "nsgDiagPolicyName": "nsg-diagnostic-settings-policyDef",
    "kvDiagPolicyName": "kv-diagnostic-settings-policyDef",
    "cognitiveDiagPolicyName": "cognitive-diagnostic-settings-policyDef",
    "dataLakeAnalyticsDiagPolicyName": "dlanalytics-diagnostic-settings-policyDef",
    "dataLakeStoreDiagPolicyName": "dlstore-diagnostic-settings-policyDef",
    "eventHubDiagPolicyName": "eventHub-diagnostic-settings-policyDef",
    "iotHubDiagPolicyName": "iotHub-diagnostic-settings-policyDef",
    "logicAppsWorkflowDiagPolicyName": "logicApps-workflow-diagnostic-settings-policyDef",
    "logicAppsIntegrationAccountsDiagPolicyName": "logicApps-integrationAccounts-diagnostic-settings-policyDef",
    "recoveryVaultDiagPolicyName": "recoveryVault-diagnostic-settings-policyDef",
    "searchServicesDiagPolicyName": "searchServices-diagnostic-settings-policyDef",
    "serviceBusDiagPolicyName": "serviceBus-diagnostic-settings-policyDef",
    "sqlDBsDiagPolicyName": "sqlDBs-diagnostic-settings-policyDef",
    "sqlElasticPoolsDiagPolicyName": "sqlElasticPools-diagnostic-settings-policyDef",
    "apiMgmtDiagPolicyName": "apiMgmt-diagnostic-settings-policyDef",
    "appGwDiagPolicyName": "appGw-diagnostic-settings-policyDef",
    "batchDiagPolicyName": "batch-diagnostic-settings-policyDef",
    "mySQLDiagPolicyName": "mySQL-diagnostic-settings-policyDef",
    "postgreSQLDiagPolicyName": "postgreSQL-diagnostic-settings-policyDef",
    "cdnEndpointsDiagPolicyName": "cdnEndpoints-diagnostic-settings-policyDef",
    "cosmosDBsDiagPolicyName": "cosmosDBs-diagnostic-settings-policyDef",
    "dataFactoryDiagPolicyName": "dataFactory-diagnostic-settings-policyDef",
    "firewallDiagPolicyName": "firewall-diagnostic-settings-policyDef",
    "powerBIEmbeddedDiagPolicyName": "powerBIEmbedded-diagnostic-settings-policyDef",
    "streamAnalyticsDiagPolicyName": "streamAnalytics-diagnostic-settings-policyDef",
    "expressRoutesDiagPolicyName": "expressRoutes-diagnostic-settings-policyDef",
    "aciDiagPolicyName": "aci-diagnostic-settings-policyDef",
    "acrDiagPolicyName": "acr-diagnostic-settings-policyDef",
    "vnetDiagPolicyName": "vnet-diagnostic-settings-policyDef",
    "vmDiagPolicyName": "vm-diagnostic-settings-policyDef",
    "vmssDiagPolicyName": "vmss-diagnostic-settings-policyDef",
    "vnetGWDiagPolicyName": "vnetGW-diagnostic-settings-policyDef",
    "aksDiagPolicyName": "aks-diagnostic-settings-policyDef",
    "websiteDiagPolicyName": "website-diagnostic-settings-policyDef",
    "analysisServiceDiagPolicyName": "analysisService-diagnostic-settings-policyDef",
    "eventGridTopicDiagPolicyName": "eventGridTopic-diagnostic-settings-policyDef",
    "eventGridSubDiagPolicyName": "eventGridSub-diagnostic-settings-policyDef",
    "hdInsightDiagPolicyName": "hdInsight-diagnostic-settings-policyDef",
    "redisCacheDiagPolicyName": "redisCache-diagnostic-settings-policyDef",
    "relayDiagPolicyName": "relay-diagnostic-settings-policyDef",
    "signalRDiagPolicyName": "signalR-diagnostic-settings-policyDef",
    "trafficManagerDiagPolicyName": "trafficManager-diagnostic-settings-policyDef",
    "timeSeriesInsightsDiagPolicyName": "timeSeriesInsights-diagnostic-settings-policyDef",
    "diagSettingsInitiativeName": "resource-diagnostic-settings-policySet"
  },
  "resources": [
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('nicDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [],
      "properties": {
        "displayName": "Apply diagnostic settings for Network Interfaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/networkInterfaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkInterfaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aaDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('nicDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Automation Accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Automation/automationAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Automation/automationAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "JobLogs",
                              "enabled": true
                            },
                            {
                              "category": "JobStreams",
                              "enabled": true
                            },
                            {
                              "category": "DscNodeStatus",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('pipDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aaDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Public IPs",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/publicIPAddresses"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/publicIPAddresses/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "DDoSProtectionNotifications",
                              "enabled": true
                            },
                            {
                              "category": "DDoSMitigationFlowLogs",
                              "enabled": true
                            },
                            {
                              "category": "DDoSMitigationReports",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('lbDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('pipDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Load Balancers",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/loadBalancers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/loadBalancers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "LoadBalancerAlertEvent",
                              "enabled": true
                            },
                            {
                              "category": "LoadBalancerProbeHealthStatus",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('nsgDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('lbDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Network Security Groups",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/networkSecurityGroups"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "NetworkSecurityGroupEvent",
                              "enabled": true
                            },
                            {
                              "category": "NetworkSecurityGroupRuleCounter",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('kvDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('nsgDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Key Vaults",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.KeyVault/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "AuditEvent",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cognitiveDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('kvDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Cognitive Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.CognitiveServices/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.CognitiveServices/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "RequestResponse",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataLakeAnalyticsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cognitiveDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Data Lake Analytics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataLakeAnalytics/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "Requests",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataLakeStoreDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataLakeAnalyticsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Data Lake Storage",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataLakeStore/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeStore/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "Requests",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventHubDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataLakeStoreDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Event Hub Namespaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventHub/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventHub/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ArchiveLogs",
                              "enabled": true
                            },
                            {
                              "category": "OperationalLogs",
                              "enabled": true
                            },
                            {
                              "category": "AutoScaleLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('iotHubDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventHubDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for IoT Hubs",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Devices/IotHubs"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Devices/IotHubs/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Connections",
                              "enabled": true
                            },
                            {
                              "category": "DeviceTelemetry",
                              "enabled": true
                            },
                            {
                              "category": "C2DCommands",
                              "enabled": true
                            },
                            {
                              "category": "DeviceIdentityOperations",
                              "enabled": true
                            },
                            {
                              "category": "FileUploadOperations",
                              "enabled": true
                            },
                            {
                              "category": "Routes",
                              "enabled": true
                            },
                            {
                              "category": "D2CTwinOperations",
                              "enabled": true
                            },
                            {
                              "category": "C2DTwinOperations",
                              "enabled": true
                            },
                            {
                              "category": "TwinQueries",
                              "enabled": true
                            },
                            {
                              "category": "JobsOperations",
                              "enabled": true
                            },
                            {
                              "category": "DirectMethods",
                              "enabled": true
                            },
                            {
                              "category": "E2EDiagnostics",
                              "enabled": true
                            },
                            {
                              "category": "Configurations",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('logicAppsWorkflowDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('iotHubDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Logic Apps workflows",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Logic/workflows"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Logic/workflows/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "WorkflowRuntime",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('logicAppsIntegrationAccountsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('logicAppsWorkflowDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Logic Apps Integration Accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Logic/integrationAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Logic/integrationAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "IntegrationAccountTrackingEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('recoveryVaultDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('logicAppsIntegrationAccountsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Recovery Vaults",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.RecoveryServices/vaults"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.RecoveryServices/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "AzureBackupReport",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryJobs",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryEvents",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicatedItems",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationStats",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryRecoveryPoints",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationDataUploadRate",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryProtectedDiskDataChurn",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('searchServicesDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('recoveryVaultDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Search Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Search/searchServices"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Search/searchServices/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('serviceBusDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('searchServicesDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Service Bus namespaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ServiceBus/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ServiceBus/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationalLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('sqlDBsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('serviceBusDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for SQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Sql/servers/databases"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "SQLInsights",
                              "enabled": true
                            },
                            {
                              "category": "AutomaticTuning",
                              "enabled": true
                            },
                            {
                              "category": "QueryStoreRuntimeStatistics",
                              "enabled": true
                            },
                            {
                              "category": "QueryStoreWaitStatistics",
                              "enabled": true
                            },
                            {
                              "category": "Errors",
                              "enabled": true
                            },
                            {
                              "category": "DatabaseWaitStatistics",
                              "enabled": true
                            },
                            {
                              "category": "Timeouts",
                              "enabled": true
                            },
                            {
                              "category": "Blocks",
                              "enabled": true
                            },
                            {
                              "category": "Deadlocks",
                              "enabled": true
                            },
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('sqlElasticPoolsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('sqlDBsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for SQL Elastic Pools",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Sql/servers/elasticPools"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('apiMgmtDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('sqlElasticPoolsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for API Management services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ApiManagement/service"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ApiManagement/service/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "Gateway Requests",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            },
                            {
                              "category": "Capacity",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            },
                            {
                              "category": "EventHub Events",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('appGwDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('apiMgmtDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Application Gateways",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/applicationGateways"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/applicationGateways/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ApplicationGatewayAccessLog",
                              "enabled": true
                            },
                            {
                              "category": "ApplicationGatewayPerformanceLog",
                              "enabled": true
                            },
                            {
                              "category": "ApplicationGatewayFirewallLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('batchDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('appGwDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Batch accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Batch/batchAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Batch/batchAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ServiceLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('mySQLDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('batchDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for MySQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DBforMySQL/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DBforMySQL/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "MySqlSlowLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('postgreSQLDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('mySQLDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for PostgreSQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DBforPostgreSQL/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "PostgreSQLLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cdnEndpointsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('postgreSQLDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for CDN Endpoints",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Cdn/profiles/endpoints"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "CoreAnalytics",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cosmosDBsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cdnEndpointsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Cosmos DB",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DocumentDB/databaseAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "Requests",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "DataPlaneRequests",
                              "enabled": true
                            },
                            {
                              "category": "MongoRequests",
                              "enabled": true
                            },
                            {
                              "category": "QueryRuntimeStatistics",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataFactoryDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cosmosDBsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Data Factory",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataFactory/factories"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataFactory/factories/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ActivityRuns",
                              "enabled": true
                            },
                            {
                              "category": "PipelineRuns",
                              "enabled": true
                            },
                            {
                              "category": "TriggerRuns",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('firewallDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataFactoryDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Firewalls",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/azureFirewalls"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/azureFirewalls/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "AzureFirewallApplicationRule",
                              "enabled": true
                            },
                            {
                              "category": "AzureFirewallNetworkRule",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('powerBIEmbeddedDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('firewallDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Power BI Embedded",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.PowerBIDedicated/capacities"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Engine",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('streamAnalyticsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('powerBIEmbeddedDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Stream Analytics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.StreamAnalytics/streamingjobs"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Execution",
                              "enabled": true
                            },
                            {
                              "category": "Authoring",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('expressRoutesDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('streamAnalyticsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Express Routes Circuits",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/expressRouteCircuits"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "PeeringRouteLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aciDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('expressRoutesDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Container Instances",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerInstance/containerGroups"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('acrDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aciDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Container Registries",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerRegistry/registries"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerRegistry/registries/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vnetDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('acrDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Virtual Networks",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/virtualNetworks"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworks/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "VMProtectionAlerts",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vmDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vnetDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Virtual Machines",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Compute/virtualMachines"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachines/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vmssDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vmDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Virtual Machine Scale Sets",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Compute/virtualMachineScaleSets"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vnetGWDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vmssDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Virtual Network Gateways",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/virtualNetworkGateways"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "IKEDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "P2SDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "RouteDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "RouteDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "TunnelDiagnosticLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aksDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vnetGWDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Kubernetes Service",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerService/managedClusters"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerService/managedClusters/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "guard",
                              "enabled": true
                            },
                            {
                              "category": "kube-apiserver",
                              "enabled": true
                            },
                            {
                              "category": "kube-controller-manager",
                              "enabled": true
                            },
                            {
                              "category": "kube-scheduler",
                              "enabled": true
                            },
                            {
                              "category": "cluster-autoscaler",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('websiteDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aksDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Web Sites",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Web/sites"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('analysisServiceDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('websiteDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Analysis Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.AnalysisServices/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.AnalysisServices/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Engine",
                              "enabled": true
                            },
                            {
                              "category": "Service",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventGridTopicDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('analysisServiceDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Event Grid Topics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventGrid/topics"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventGrid/topics/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventGridSubDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventGridTopicDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Event Grid Subscriptions",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventGrid/eventSubscriptions"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('hdInsightDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventGridSubDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for HDInsight",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.HDInsight/clusters"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.HDInsight/clusters/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('redisCacheDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('hdInsightDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Redis Cache",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Cache/redis"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Cache/redis/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('relayDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('redisCacheDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Relay",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Relay/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Relay/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('signalRDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('relayDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for SignalR",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.SignalRService/SignalR"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.SignalRService/SignalR/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('trafficManagerDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('signalRDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Azure Traffic Manager",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/trafficManagerProfiles"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ProbeHealthStatusEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('timeSeriesInsightsDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('trafficManagerDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for Time Series Insights",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Monitoring"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.TimeSeriesInsights/environments"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policySetDefinitions",
      "name": "[variables('diagSettingsInitiativeName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('timeSeriesInsightsDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "Apply diagnostic settings for applicable resources",
        "description": "This initiative configures application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyDefinitions": [
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('nicDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aaDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('pipDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('lbDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('nsgDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('kvDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cognitiveDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataLakeAnalyticsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataLakeStoreDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventHubDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('iotHubDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('logicAppsWorkflowDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('logicAppsIntegrationAccountsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('recoveryVaultDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('searchServicesDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('serviceBusDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('sqlDBsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('sqlElasticPoolsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('apiMgmtDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('appGwDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('batchDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('mySQLDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('postgreSQLDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cdnEndpointsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cosmosDBsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataFactoryDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('firewallDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('powerBIEmbeddedDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('streamAnalyticsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('expressRoutesDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aciDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('acrDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vnetDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vmDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vmssDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vnetGWDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aksDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('websiteDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('analysisServiceDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventGridTopicDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventGridSubDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('hdInsightDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('redisCacheDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('relayDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('signalRDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('trafficManagerDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('timeSeriesInsightsDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          }
        ]
      }
    }
  ],
  "outputs": {}
}